{"version":3,"sources":["../node_modules/peerjs/dist sync","components/RemoteList.jsx","components/Socket.jsx","components/PeerMake.jsx","logo.svg","store/initState.js","store/store.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","connect","state","remotes","vidRef","useRef","useEffect","document","me","on","call","a","answer","remoteStream","current","srcObject","addEventListener","client","peer","send","touches","movementX","movementY","window","screen","availHeight","availWidth","getBoundingClientRect","top","left","width","height","x","y","arr","Math","round","socket","emit","className","map","onClick","navigator","mediaDevices","getDisplayMedia","video","audio","stream","clients","ref","autoPlay","controls","Socket","useState","conn","setConn","io","data","nanoid","customAlphabet","remote","dispatch","addPeer","type","key","setKey","youKey","setYouKey","Peer","console","log","value","placeholder","onChange","target","onBlur","b","initState","main","produce","action","push","store","createStore","composeWithDevTools","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ae9b2efd.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 42;","import React, { useEffect, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport \"./_One.scss\";\r\nexport default connect((state) => ({ remotes: state.remotes }))(\r\n  function RemoteList({ remotes }) {\r\n    const vidRef = useRef();\r\n\r\n    const handleCall = (id) => {\r\n      // document.remotes[id].send(\"hi\");\r\n      return async () => {\r\n        let stream = await navigator.mediaDevices.getDisplayMedia({\r\n          video: true,\r\n          audio: true,\r\n        });\r\n\r\n        var call = document.me.call(id, stream);\r\n        call.on(\"stream\", function (remoteStream) {\r\n          vidRef.current.srcObject = remoteStream;\r\n          vidRef.current.addEventListener(\"touchmove\", (e) => {\r\n            document.clients[id].send(e);\r\n          });\r\n        });\r\n      };\r\n    };\r\n    useEffect(() => {\r\n      document.me.on(\"call\", async function (call) {\r\n        // let stream = await navigator.mediaDevices.getDisplayMedia({\r\n        //   // video: true,\r\n        //   audio: true,\r\n        // });\r\n\r\n        call.answer(null); // Answer the call with an A/V stream.\r\n        call.on(\"stream\", function (remoteStream) {\r\n          // Show stream in some video/canvas element.\r\n          // console.log(call)\r\n          vidRef.current.srcObject = remoteStream;\r\n          // console.log(call);\r\n          // document.clients[pee]\r\n          vidRef.current.addEventListener(\"touchmove\", (e) => {\r\n            document.client[call.peer].send([\r\n              e.touches[0].movementX,\r\n              e.touches[0].movementY,\r\n            ]);\r\n            // console.log([e.movementX, e.movementY]);\r\n          });\r\n          //   vidRef.current.addEventListener(\"mousemove\", (e) => {\r\n          //     // document.client[call.peer].send(JSON.stringify({ ...e }));\r\n          //     console.table(e);\r\n          //   });\r\n          // });\r\n        });\r\n      });\r\n      vidRef.current.addEventListener(\"mousemove\", (e) => {\r\n        const { availHeight, availWidth } = window.screen;\r\n        // console.log(window.screen);\r\n        let { top, left, width, height } =\r\n          vidRef.current.getBoundingClientRect();\r\n        const { x, y } = e;\r\n        // document.client[call.peer].send(JSON.stringify({ ...e }));\r\n        let arr = [\r\n          Math.round(((x - left) * availWidth) / width),\r\n          Math.round(((y - top) * availHeight) / height),\r\n        ];\r\n        document.socket.emit(\"mousemove\", arr);\r\n      });\r\n    }, []);\r\n    return (\r\n      <div className=\"RemoteList\">\r\n        {remotes?.map((e) => {\r\n          return (\r\n            <div key={e}>\r\n              {\" \"}\r\n              {e} <button onClick={handleCall(e)}>Call</button>\r\n            </div>\r\n          );\r\n        })}\r\n        <video className=\"RemoteList_video\" ref={vidRef} autoPlay controls />\r\n      </div>\r\n    );\r\n  }\r\n);\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nexport default function Socket() {\r\n  const [conn, setConn] = useState(false);\r\n  useEffect(() => {\r\n    const socket = io(\"http://localhost:5000/\");\r\n    document.socket = socket;\r\n    socket.on(\"connect\", () => {\r\n      //   console.log(\"socket connected\");\r\n      setConn(true);\r\n    });\r\n    socket.on(\"done\", (data) => {\r\n      //   console.log(data);\r\n      //   socket.emit(\"mousemove\", { x: data.x + 2, y: data.y + 2 });\r\n    });\r\n  }, []);\r\n  return <div className=\"Socket\">{conn && \"Connected\"}</div>;\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport Peer from \"peerjs\";\r\nimport \"./_One.scss\";\r\nimport { customAlphabet } from \"nanoid\";\r\nimport { connect } from \"react-redux\";\r\nimport RemoteList from \"./RemoteList\";\r\nimport Socket from \"./Socket\";\r\nconst nanoid = customAlphabet(\"abcdef\", 4);\r\n//=> \"4f90d13a42\"\r\ndocument.remote = {};\r\ndocument.client = {};\r\nexport default connect(\r\n  (state) => ({}),\r\n  (dispatch) => ({\r\n    addPeer: ({ type, id }) =>\r\n      dispatch({ type: \"ADD_PEER\", data: { type, id } }),\r\n  })\r\n)(function PeerMake({ addPeer }) {\r\n  const [key, setKey] = useState(null);\r\n  const [youKey, setYouKey] = useState(\"\");\r\n  const handleSetYouKey = (e) => {\r\n    let key = e.target.value;\r\n    setYouKey(key);\r\n  };\r\n\r\n  const makeConnection = () => {\r\n    // document.client.connect(youKey)\r\n    var client = document.me.connect(youKey);\r\n    client.on(\"open\", () => {\r\n      client.on(\"data\", (data) => {\r\n        console.log(data);\r\n      });\r\n      //   setInterval(() => {\r\n      client.send({ a: window.screen.width, b: window.screen.height });\r\n      document.client[youKey] = client;\r\n      addPeer({ type: \"clients\", id: youKey });\r\n\r\n      //   }, 500);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    let client = new Peer(nanoid());\r\n    client.on(\"open\", (id) => {\r\n      document.me = client;\r\n      console.log(id);\r\n      setKey(id);\r\n    });\r\n\r\n    // when client make connection to someone, and he is waiting for connection\r\n    client.on(\"connection\", function (remote) {\r\n      remote.on(\"open\", () => {\r\n        remote.on(\"data\", function (data) {\r\n          console.log(\"Incoming data\", data);\r\n          //   remote.send(\"Left\");\r\n        });\r\n        document.remote[remote.peer] = remote;\r\n        addPeer({ type: \"remotes\", id: remote.peer });\r\n      });\r\n    });\r\n\r\n    //   remote.send(\"hi\");\r\n    //   remote.send({ hi: \"hi\" });\r\n  }, []);\r\n  return (\r\n    <div className=\"PeerMake\">\r\n      <input className=\"PeerMake_input_me\" type=\"text\" value={key} />\r\n      <input\r\n        className=\"PeerMake_input_you\"\r\n        type=\"text\"\r\n        placeholder=\"enter key..\"\r\n        value={youKey}\r\n        onChange={handleSetYouKey}\r\n        onBlur={makeConnection}\r\n      />\r\n      <Socket />\r\n      {key && <RemoteList />}\r\n    </div>\r\n  );\r\n});\r\n","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","const initState = {\r\n  remotes: [],\r\n  clients: [],\r\n};\r\nexport default initState;\r\n","// import main from \"./reducers/\";\r\nimport { createStore } from \"redux\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\nimport produce, { current } from \"immer\";\r\nimport initState from \"./initState\";\r\n// const initState = {\r\n//   ab: [],\r\n// };\r\nconst main = produce((state = initState, action) => {\r\n  const { data, type } = action;\r\n\r\n  switch (type) {\r\n    case \"ADD_PEER\":\r\n      state[data.type].push(data.id);\r\n\r\n      break;\r\n\r\n    default:\r\n      return state;\r\n      break;\r\n  }\r\n});\r\nconst store = createStore(main /* preloadedState, */, composeWithDevTools());\r\n// const Store = store();\r\nexport default store;\r\n","import { useEffect } from \"react\";\nimport PeerMake from \"./components/PeerMake\";\nimport RemoteList from \"./components/RemoteList\";\nimport logo from \"./logo.svg\";\nimport store from \"./store/store\";\nimport \"./_App.scss\";\n\nfunction App() {\n  useEffect(() => {\n    console.log(store);\n  });\n  return (\n    <div className=\"App\">\n      <PeerMake />\n      <h1>Hello</h1>\n      {/* <RemoteList /> */}\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { Provider } from \"react-redux\";\nimport store from \"./store/store\";\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}